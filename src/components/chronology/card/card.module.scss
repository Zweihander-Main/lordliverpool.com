@use '~styles/util/variables.global' as v;
@use '~styles/util/mixins.global' as m;
@use '~styles/util/functions.global' as f;
@use '../chronology.module.scss' as c;

$card-border: 35px;

.card {
	//TODO remove color vars
	@include m.neumorphic-intensity(
		12px,
		25px,
		v.$blue-bg,
		80%
	); // TODO consistency with rest of site

	background-color: v.$blue-card-bg;
	border-radius: v.$border-radius;
	box-sizing: border-box;
	color: v.$white;
	display: grid;
	grid-template-columns: 100%;
	grid-template-rows: 1fr $card-border;
	margin: 0 c.$card-margin 0 0;
	max-height: calc(
		100vh - #{c.$filter-menu-height} - #{c.$timeline-height} - 45px
	);
	overflow: hidden;
	width: c.$card-width; //TODO right?
	will-change: transform, width, margin;
	transition: none;

	animation: slidein 0ms v.$timing-function;
	animation-fill-mode: both;
	@include m.media('portrait') {
		margin: 0 auto c.$card-margin auto;
		max-height: 100%;
		width: 80vw; //TODO var
		will-change: height, margin;
	}
}

@keyframes slideout {
	0% {
		transform: scaleX(1);
	}
	99.9% {
		transform: scaleX(0);
	}
	100% {
		margin: 0;
		width: 0;
	}
}

@keyframes slidein {
	0% {
		// width: c.$card-width;
		// margin: 0 c.$card-margin 0 0;
		transform: scaleX(0);
	}
	100% {
		transform: scaleX(1);
	}
}

.hidden {
	animation: slideout 0ms v.$timing-function;
	animation-fill-mode: both;
	// margin: 0;
	// width: 0;
	@include m.media('portrait') {
		height: 0;
		width: initial;
	}
}

.animate {
	animation-duration: 250ms;
}

.inner {
	@include m.custom-scrollbar(v.$blue-card-bg, v.$white);

	border: $card-border solid transparent;
	box-sizing: border-box;
	grid-column: 1;
	grid-row-end: 3;
	grid-row-start: 1;
	overflow-y: auto;
	width: c.$card-width;
	display: grid;
	grid-template-rows: minmax(0, max-content) minmax(0, min-content) minmax(
			0,
			max-content
		); //TODO massacre of tranent and perfect spacing
	grid-template-columns: 1fr;
	//TODO name grids everywhere
	// TODO remove image named grid

	@include m.media('portrait') {
		width: 80vw; //TODO var
	}
}

.header {
	outline: none;

	.title-link {
		@include m.fancy-hover-link($color: v.$white, $bottom: 2px);
	}
}

.title-link {
	color: v.$white;
	margin-bottom: 1rem;

	.image {
		margin-bottom: 0;
	}
}

.header-no-image {
	margin-top: 0;
}

.image {
	// max-height: c.$card-height * 0.7; // TODO do something better than this //TODO figure out how new system should work
	object-fit: contain;
	object-position: center 35%;
	outline: none;
	width: 100%;
	max-height: 100%;
	margin-bottom: 1rem;

	// @include m.media('height>HEIGHT_med', 'height<=HEIGHT_tall') {
	// 	max-height: c.$card-height * 0.6;
	// }
	// @include m.media('height>HEIGHT_short', 'height<=HEIGHT_med') {
	// 	max-height: c.$card-height * 0.5;
	// }
	// @include m.media('height<=HEIGHT_short') {
	// 	max-height: c.$card-height * 0.4;
	// } //TODO allow all in portrait

	@include m.media('portrait') {
		max-height: 80vh;
	}
}
// TODO Zoom
// TODO fix mixins and ect. for breakpoints
// TODO border on bottom of menu

.text {
	white-space: break-spaces;
}

.display-date {
	align-self: center;
	grid-column: 1;
	grid-row: 2;
	overflow: hidden;
	text-align: center;
	text-transform: uppercase;
	width: c.$card-width;
}
